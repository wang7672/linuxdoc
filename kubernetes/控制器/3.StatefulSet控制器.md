# StatefulSet控制器

### 什么是有状态服务，什么是无状态服务

```
无状态服务(Stateless Service)：该服务运行的实例不会在本地存储需要的持久化数据，且多个实例对于同一个请求响应的结果是完全一致的

有状态服务(Stateful Service)：和无状态服务相对立，需要在运行的实例本地存储持久化数据。多个实例对于同一个请求如果实例内的数据异不相同，则返回的结果也不复相同
```

由于无状态组件没有预定义的启动顺序、集群要求、点对点TCP连接、唯一的网络标识符、正常的启动和终止要求等，因此可以很容易地进行容器化。诸如数据库，大数据分析系统，分布式key/value存储、消息中间件需要有复杂的分布式体系结构，都可能会用到上述功能。因此，Kubernetes引入了 StatefulSet 这种资源对像来支持这种复杂的需求。

StatefulSet可以处理Pod的启动顺序，为保留每个Pod的状态设置唯一标识，具有以下几个功能特性：

1. 稳定的、唯一的网络标识符
2. 稳定的、持久的存储
3. 有序的、优雅的部署和缩放
4. 有序的、优雅的删除和终止
5. 有序的、自动滚动更新



### StatefulSet 控制器创建 

```
需要创建对应的 svc  pv  pvc
并且需要一一相互对应

StatefulSet中pod副本的创建会按照序列号升序处理，副本的更新和删除则会按照降序处理
```

<img src=../img/statefulset.jpg style="zoom:78%;" />









































